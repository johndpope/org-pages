#+TITLE: Threat Intelligence 情报收集爬虫

此文档记录了爬取开源情报的一些细节，[[https://github.com/Nanue1/opensource_threat_intel][爬虫项目]] 已经不再更新!

* data source introduction
** ioc数据基本信息说明
   - 情报指标维度

      | indictor | 存储值 |
      |----------+--------|
      | ip       |      0 |
      |----------+--------|
      | domain   |      1 |
      |----------+--------|
      | url      |      2 |
      |----------+--------|
      | md5      |      3 |
      |----------+--------|
      | sha256   |      4 |
      |----------+--------|
      | sha1     |      5 |
      |----------+--------|
   - tags 标签说明

     | 序号 | 恶意类型     | 说明           |
     |------+--------------+----------------|
     |    0 | Suspicious   | 可疑的         |
     |------+--------------+----------------|
     |    1 | DDos         | DDos攻击       |
     |------+--------------+----------------|
     |    2 | Exploits     | 漏洞攻击       |
     |------+--------------+----------------|
     |    3 | Spam Sources | 垃圾邮件       |
     |------+--------------+----------------|
     |    4 | Web  Attacks | Web攻击        |
     |------+--------------+----------------|
     |    5 | Scanners     | 扫描源         |
     |------+--------------+----------------|
     |    6 | Botnets      | 僵尸网络被控端 |
     |------+--------------+----------------|
     |    7 | Malware      | 恶意软件       |
     |------+--------------+----------------|
     |    8 | Phishing     | 钓鱼           |
     |------+--------------+----------------|
     |    9 | Proxy        | 代理           |
     |------+--------------+----------------|
     |   10 | C&C          | 僵尸网络控制端 |
     |------+--------------+----------------|
     |   11 | Whitelist    | 白名单         |
     |------+--------------+----------------|
     |   12 | Honeypot     | 蜜罐           |
     |------+--------------+----------------|
     |   13 | DGA          | 域名随机生成   |
     |------+--------------+----------------|
   - confidence 可信度字段说明
     | 置信度 | 取值范围说明       |
     |--------+--------------------|
     | (9-10) | Certain            |
     |--------+--------------------|
     | (7-8)  | Very Confident     |
     |--------+--------------------|
     | (6-7)  | Somewhat Confident |
     |--------+--------------------|
     | (5-6)  | Not Confident      |
     |--------+--------------------|
     | (5)    | "50/50 shot"       |
     |--------+--------------------|
     | (0-4)  | Informational Data |
     |--------+--------------------|
   - 数据库内存储格式
     + 录入机制:

       同一数据源来的数据，威胁类型不变时，

       只更新该类型记录更新时间,created_time不会变化
     
       当indicator 和 tag都变化的时候，才会录入一条新的数据
     + 更新机制

       每天通过created_time获取新数据
     #+BEGIN_SRC json
     {
        "indicator":"1.180.74.58",
        "data_type":0,
        "confidence":7,
        "alive":true/false,
        "updated_time":"2017-06-30T14:22:44"/"none",
        "source":"blocklist.de",
        "tag":5,
        "created_time":"2017-06-30T14:22:44"
        "description":""
     }
     #+END_SRC
** 数据源各维度统计
|------------------------------+---------+------+--------+-----+---------+----------+-----------+---------+------+---------+----------+----------+------------+-------------------+---------|
|                              | scanner | spam | botnet | c&c | malware | phishing | whitelist | darknet | ddos | exploit | honeypot | hijacked | suspicious | data-type         |     sum |
|------------------------------+---------+------+--------+-----+---------+----------+-----------+---------+------+---------+----------+----------+------------+-------------------+---------|
| alexa.com                    |         |      |        |     |         |          |         5 |         |      |         |          |          |            | DOMAIN            |    1529 |
|------------------------------+---------+------+--------+-----+---------+----------+-----------+---------+------+---------+----------+----------+------------+-------------------+---------|
| reputation.alienvault.com    |       7 |    6 |        |     |       6 |          |           |         |      |         |          |          |            | IP                |   31978 |
|------------------------------+---------+------+--------+-----+---------+----------+-----------+---------+------+---------+----------+----------+------------+-------------------+---------|
| osint.bambenekconsulting.com |         |      |      9 |     |         |          |           |         |      |         |          |          |            | IP                |  865311 |
|------------------------------+---------+------+--------+-----+---------+----------+-----------+---------+------+---------+----------+----------+------------+-------------------+---------|
| blocklist.de                 |       7 |      |      7 |     |         |          |           |         |      |         |          |          |            | IP                |   68711 |
|------------------------------+---------+------+--------+-----+---------+----------+-----------+---------+------+---------+----------+----------+------------+-------------------+---------|
| umbrella.cisco.com           |         |      |        |     |         |          |         5 |         |      |         |          |          |            | DOMAIN            |    1134 |
|------------------------------+---------+------+--------+-----+---------+----------+-----------+---------+------+---------+----------+----------+------------+-------------------+---------|
| csirtg.io                    |       9 |    9 |        |     |         |          |           |       9 |      |         |          |          |            | IP,URL,           |    1037 |
|------------------------------+---------+------+--------+-----+---------+----------+-----------+---------+------+---------+----------+----------+------------+-------------------+---------|
| danger.rulez.sk              |       9 |      |        |     |         |          |           |         |      |         |          |          |            | IP                |    1254 |
|------------------------------+---------+------+--------+-----+---------+----------+-----------+---------+------+---------+----------+----------+------------+-------------------+---------|
| dataplane.org                |       9 |      |        |     |         |          |           |         |      |         |          |          |            | IP                |   46710 |
|------------------------------+---------+------+--------+-----+---------+----------+-----------+---------+------+---------+----------+----------+------------+-------------------+---------|
| emergingthreats.net          |         |      |        |     |       8 |          |           |         |      |         |          |          |            | IP                |    1289 |
|------------------------------+---------+------+--------+-----+---------+----------+-----------+---------+------+---------+----------+----------+------------+-------------------+---------|
| abuse.ch                     |         |      |   8-10 |     |         |          |           |         |      |         |          |          |            | URL ,IP ,MD5      |   16810 |
|------------------------------+---------+------+--------+-----+---------+----------+-----------+---------+------+---------+----------+----------+------------+-------------------+---------|
| malc0de.com                  |         |      |        |     |       9 |          |           |         |      |         |          |          |            | URL,IP,MD5        |       0 |
|------------------------------+---------+------+--------+-----+---------+----------+-----------+---------+------+---------+----------+----------+------------+-------------------+---------|
| mirc.com                     |         |      |        |     |         |          |         8 |         |      |         |          |          |            | URL               |     191 |
|------------------------------+---------+------+--------+-----+---------+----------+-----------+---------+------+---------+----------+----------+------------+-------------------+---------|
| netlab.360.com               |         |      |      7 |     |       7 |          |           |         |      |       7 |          |          |            | IP,URL,DOMAIN,MD5 |  889955 |
|------------------------------+---------+------+--------+-----+---------+----------+-----------+---------+------+---------+----------+----------+------------+-------------------+---------|
| nothink.org                  |       7 |      |        |     |         |          |           |         |      |         |          |          |            | IP                |     193 |
|------------------------------+---------+------+--------+-----+---------+----------+-----------+---------+------+---------+----------+----------+------------+-------------------+---------|
| openphish.com                |         |      |        |     |         |        9 |           |         |      |         |          |          |            | URL               |    5352 |
|------------------------------+---------+------+--------+-----+---------+----------+-----------+---------+------+---------+----------+----------+------------+-------------------+---------|
| packetmail.net               |       8 |      |        |     |         |          |           |         |      |         |        8 |          |            | IP                |   16424 |
|------------------------------+---------+------+--------+-----+---------+----------+-----------+---------+------+---------+----------+----------+------------+-------------------+---------|
| phishtank.com                |         |      |        |     |         |        9 |           |         |      |         |          |          |            | IP                |   27128 |
|------------------------------+---------+------+--------+-----+---------+----------+-----------+---------+------+---------+----------+----------+------------+-------------------+---------|
| isc.sans.edu                 |       8 |      |        |     |         |          |           |         |      |         |          |          |        7-9 | IP                |       0 |
|------------------------------+---------+------+--------+-----+---------+----------+-----------+---------+------+---------+----------+----------+------------+-------------------+---------|
| spamhaus.org                 |         |      |        |     |         |          |           |         |      |         |          |        9 |            | ASN,IPv6,Network  |    1241 |
|------------------------------+---------+------+--------+-----+---------+----------+-----------+---------+------+---------+----------+----------+------------+-------------------+---------|
| vxvault.net                  |         |      |        |     |       9 |          |           |         |      |         |          |          |            | IP                |     196 |
|------------------------------+---------+------+--------+-----+---------+----------+-----------+---------+------+---------+----------+----------+------------+-------------------+---------|
| otx.alienvault.com           |       5 |    5 |        |     |       5 |        5 |           |         |    5 |         |          |          |          5 | IP,URL,MD5        |       0 |
|------------------------------+---------+------+--------+-----+---------+----------+-----------+---------+------+---------+----------+----------+------------+-------------------+---------|
| antispam.imp.ch              |         |    9 |        |     |         |          |           |         |      |         |          |          |            | IP                |       0 |
|------------------------------+---------+------+--------+-----+---------+----------+-----------+---------+------+---------+----------+----------+------------+-------------------+---------|
| dragonresearchgroup.org      |       9 |      |        |     |         |          |           |         |      |         |          |          |            | IP                |       0 |
|------------------------------+---------+------+--------+-----+---------+----------+-----------+---------+------+---------+----------+----------+------------+-------------------+---------|
| watcherlab.com               |         |      |        |   9 |         |          |           |         |      |         |          |          |            | IP                |       0 |
|------------------------------+---------+------+--------+-----+---------+----------+-----------+---------+------+---------+----------+----------+------------+-------------------+---------|
| sum                          |         |      |        |     |         |          |           |         |      |         |          |          |            |                   | 1976443 |
|------------------------------+---------+------+--------+-----+---------+----------+-----------+---------+------+---------+----------+----------+------------+-------------------+---------|
#+TBLFM: @36$14='(+ @1$14..@36$14);N
      
** DONE reputation.alienvault.com
   CLOSED: [2017-07-14 Fri 15:45]
   - State "DONE"       from ""           [2017-07-14 Fri 15:45]
** DONE osint.bambenekconsulting.com
   CLOSED: [2017-07-03 Mon 16:49]
   - State "DONE"       from "TODO"       [2017-07-03 Mon 16:49]
   - State "TODO"       from ""           [2017-06-30 Fri 16:26]
** DONE blocklist.de
   CLOSED: [2017-06-30 Fri 14:33]
   - State "DONE"       from "TODO"       [2017-06-30 Fri 14:33]
   - State "TODO"       from ""           [2017-06-29 Thu 14:07]
** DONE emergingthreats.net
   CLOSED: [2017-06-29 Thu 13:32]
   - State "DONE"       from ""           [2017-06-29 Thu 13:32]
** DONE netlab.360.com
   CLOSED: [2017-06-30 Fri 16:02]
   - State "DONE"       from "UNDO"       [2017-07-04 Tue 11:17]
   - State "UNDO"       from ""           [2017-06-30 Fri 16:02]
** DONE abuse.ch
   CLOSED: [2017-07-12 Wed 17:19]
   - State "DONE"       from "TODO"       [2017-07-12 Wed 17:19]
   - State "TODO"       from ""           [2017-07-05 Wed 12:04]
*** DONE sslbl.abuse.ch
    CLOSED: [2017-07-06 Thu 16:13]
    - State "DONE"       from ""           [2017-07-06 Thu 16:13]
*** DONE zeustracker.abuse.ch
    CLOSED: [2017-07-12 Wed 16:34]
    - State "DONE"       from ""           [2017-07-12 Wed 16:34]

*** DONE feodotracker.abuse.ch
    CLOSED: [2017-07-12 Wed 16:58]
    - State "DONE"       from ""           [2017-07-12 Wed 16:58]
*** DONE ransomware.abuse.ch
    CLOSED: [2017-07-12 Wed 17:19]
    - State "DONE"       from ""           [2017-07-12 Wed 17:19]
** DONE antispam.imp.ch
   CLOSED: [2017-06-28 Wed 10:38]
   - State "DONE"       from ""           [2017-06-28 Wed 10:38]
** DONE alexa.com
   CLOSED: [2017-07-19 Wed 15:38]
   - State "DONE"       from "TODO"       [2017-07-19 Wed 15:38]
   - State "TODO"       from ""           [2017-07-14 Fri 19:54]

   [[http://s3.amazonaws.com/alexa-static/top-1m.csv.zip][top-1000]]

** DONE public-dns.info
   CLOSED: [2017-07-20 Thu 14:16]
   - State "DONE"       from "TODO"       [2017-07-20 Thu 14:16]
** DONE umbrella.cisco.com
   CLOSED: [2017-07-24 Mon 17:12]
   - State "DONE"       from "TODO"       [2017-07-24 Mon 17:12]
   - State "TODO"       from ""           [2017-07-17 Mon 10:16]
** DONE danger.rulez.sk
   CLOSED: [2017-07-25 Tue 11:12]
   - State "DONE"       from "TODO"       [2017-07-25 Tue 11:12]
   - State "TODO"       from ""           [2017-07-17 Mon 10:16]
** DONE csirtg.io
   CLOSED: [2017-07-25 Tue 13:48]
   - State "DONE"       from "TODO"       [2017-07-25 Tue 13:48]
   - State "TODO"       from ""           [2017-07-17 Mon 10:16]
** DONE dataplane.org
   CLOSED: [2017-08-07 Mon 14:08]
   - State "DONE"       from "TODO"       [2017-08-07 Mon 14:08]
   - State "TODO"       from ""           [2017-07-25 Tue 13:48]
** DONE malc0de.com
   CLOSED: [2017-08-07 Mon 15:18]
   - State "DONE"       from "TODO"       [2017-08-07 Mon 15:18]
   - State "TODO"       from ""           [2017-07-25 Tue 13:48]

** UNDO mirc.com
   CLOSED: [2017-08-07 Mon 15:43]
   - State "UNDO"       from "TODO"       [2017-08-07 Mon 15:43]

     提供了几十个irc聊天服务器的域名地址,而且是2016年就停止更新了

   - State "TODO"       from ""           [2017-07-25 Tue 13:48]
      
** DONE nothink.org
   CLOSED: [2017-08-07 Mon 15:52]
   - State "DONE"       from "TODO"       [2017-08-07 Mon 15:52]
   - State "TODO"       from "DONE"       [2017-07-25 Tue 13:49]
** DONE openphish.com
   CLOSED: [2017-08-07 Mon 15:59]
   - State "DONE"       from "TODO"       [2017-08-07 Mon 15:59]
   - State "TODO"       from ""           [2017-07-25 Tue 13:49]
** DONE vxvazlt.net 
   CLOSED: [2017-08-23 Wed 17:36]
   - State "DONE"       from "TODO"       [2017-08-23 Wed 17:36]
   - State "TODO"       from ""           [2017-08-21 Mon 16:16]

** DONE spamhaus.org
   CLOSED: [2017-09-25 Mon 14:33]
   - State "DONE"       from "SOMEDAY"    [2017-09-25 Mon 14:33]
   需要代理 asn数据待入
   - State "TODO"       from "TODO"       [2017-08-23 Wed 12:17]
   - State "TODO"       from ""           [2017-08-21 Mon 16:16]
** DONE phishtank.com
   CLOSED: [2017-09-25 Mon 14:32]
   - State "DONE"       from "TODO"       [2017-09-25 Mon 14:32]
   - State "TODO"       from ""           [2017-08-21 Mon 16:16]
** DONE dragonresearchgroup.org
   CLOSED: [2017-09-25 Mon 14:32]
   - State "DONE"       from "TODO"       [2017-09-25 Mon 14:32]
   - State "TODO"       from ""           [2017-09-04 Mon 11:00]
** DONE watcherlab.com
   CLOSED: [2017-10-10 Tue 17:44]
   - State "DONE"       from "TODO"       [2017-10-10 Tue 17:44]
   - State "TODO"       from "DONE"       [2017-10-10 Tue 17:27]
   - State "DONE"       from "DONE"       [2017-10-10 Tue 17:27]
   - State "TODO"       from ""           [2017-09-04 Mon 11:00]
** TODO isc.sans.edu
   需要代理 
   - State "TODO"       from "DONE"       [2017-08-24 Thu 09:51]
   - State "DONE"       from "TODO"       [2017-08-24 Thu 09:51]
   - State "TODO"       from ""           [2017-08-21 Mon 16:16]
   - source url :
      1. https://isc.sans.edu/feeds/suspiciousdomains_Low.txt
      2. https://isc.sans.edu/feeds/suspiciousdomains_High.txt
      3. https://isc.sans.edu/feeds/suspiciousdomains_Medium.txt
      4. https://isc.sans.edu/feeds/block.txt
** TODO packetmail.net
   代理问题
   - State "TODO"       from "DONE"       [2017-09-04 Mon 10:58]
   - State "DONE"       from "TODO"       [2017-08-24 Thu 09:51]
   - State "TODO"       from "DONE"       [2017-08-15 Tue 09:57]
   - source url :
     1. https://www.packetmail.net/iprep.txt
     2. https://www.packetmail.net/iprep_mail.txt
     3. https://www.packetmail.net/iprep_ramnode.txt
** TODO otx.alienvault.com
   - State "TODO"       from ""           [2017-10-10 Tue 15:22]
   - source url :
      1. https://sslbl.abuse.ch/blacklist/sslipblacklist.csv
      2. https://sslbl.abuse.ch/blacklist/dyre_sslipblacklist.csv
      3. https://sslbl.abuse.ch/blacklist/sslblacklist.csv
** TODO malwaredomainlist.com
   - State "TODO"       from ""           [2017-09-25 Mon 14:35]
     
** TODO badips.com
   - State "TODO"       from              [2018-11-09 Fri 12:02]
    source url : 
    1. https://www.badips.com/get/list/any/2?age=7d

** TODO raw.githubusercontent.com
   - State "TODO"       from              [2018-11-09 Fri 12:03]
   source url: 
   1. https://raw.githubusercontent.com/firehol/blocklist-ipsets/master/botscout_1d.ipset
   2. https://raw.githubusercontent.com/firehol/blocklist-ipsets/master/cruzit_web_attacks.ipset

** TODO cinsscore.com
   - State "TODO"       from              [2018-11-09 Fri 12:03]
   source url: 
   1. http://cinsscore.com/list/ci-badguys.txt

** TODO cybercrime-tracker.net
   - State "TODO"       from              [2018-11-09 Fri 12:03]
   source url:
   1. http://cybercrime-tracker.net/ccam.php

** TODO dataplane.org
   - State "TODO"       from              [2018-11-09 Fri 12:03]
   source url: 
   1. https://dataplane.org/dnsrd.txt
   2. https://dataplane.org/dnsrd.txt
   3. https://dataplane.org/dnsversion.txt
   4. https://dataplane.org/vncrfb.txt

** TODO blocklist.greensnow.co
   - State "TODO"       from              [2018-11-09 Fri 12:04]
   source url: 
   1. http://blocklist.greensnow.co/greensnow.txt

** TODO malwaredomainlist.com
   - State "TODO"       from              [2018-11-09 Fri 12:04]
   source url:
   1. http://www.malwaredomainlist.com/hostslist/ip.txt

** TODO maxmind.com
   - State "TODO"       from              [2018-11-09 Fri 12:04]
   source url: 
   1. https://www.maxmind.com/en/high-risk-ip-sample-list

** TODO rutgers.edu
   - State "TODO"       from              [2018-11-09 Fri 12:05]
   source url: 
   1. https://report.cs.rutgers.edu/DROP/attackers
