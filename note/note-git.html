<!DOCTYPE html>
<html lang="zh-CN">
<head>
<!-- 2019-01-24 Thu 21:14 -->
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>git note</title>
<meta name="generator" content="Org mode">
<meta name="author" content="manue1">
<link rel="stylesheet" type="text/css" href="css/worg.css" />
<!-- <link rel="shortcut icon" href="http://www.langdebuqing.com/images/favicon.ico" type="image/x-icon" /> -->
</head>
<body>
<div id="preamble" class="status">
<div id="navbar">
    <ul>
        <li id="site-master"><a href="https://www.manue1.site/">Manue1's Journal</a></li>
        <li><a class="navbar-item" href="https://www.manue1.site/write.html">All Posts</a> </li>
        <li><a class="navbar-item" href="https://www.manue1.site/link.html">Links</a> </li>
        <li class="search">
            <form action="http://google.com/search" method="get" accept-charset="utf-8">
                <input type="search" id="search" name="q" autocomplete="off" maxlength="30" placeholder="Search..">
                <input type="hidden" name="q" value="site:www.manue1.com">
            </form>
        </li>
    </ul>
</div>
</div>
<div id="content">
<h1 class="title">git note</h1>
<div id="table-of-contents">
<h2>&#30446;&#24405;</h2>
<div id="text-table-of-contents">
<ul>
<li><a href="#orgdf3b5d5">1. git 独奏</a>
<ul>
<li><a href="#org3c38767">1.1. git 初始化</a></li>
<li><a href="#orgc5cc582">1.2. git 暂存区</a></li>
<li><a href="#org8a7e146">1.3. git reset 重置</a></li>
<li><a href="#org1224446">1.4. git 检出</a></li>
<li><a href="#orgfbc6e6e">1.5. git 恢复进度</a></li>
<li><a href="#org615a620">1.6. git 基础操作</a></li>
<li><a href="#orgc0aa750">1.7. git tools</a></li>
<li><a href="#org7602843">1.8. 改变历史</a></li>
<li><a href="#orga77cb6c">1.9. git克隆</a></li>
</ul>
</li>
<li><a href="#org210a79d">2. git 和声</a>
<ul>
<li><a href="#org2a472d1">2.1. git 工作协调</a></li>
<li><a href="#org7fafb5c">2.2. git 冲突解决</a></li>
</ul>
</li>
<li><a href="#org0f1c0f5">3. common questions</a>
<ul>
<li><a href="#org42b1b90">3.1. git ls-files 乱码问题</a></li>
<li><a href="#org3c4e036">3.2. change git push user</a></li>
<li><a href="#org70a8467">3.3. create branch</a></li>
<li><a href="#org9862454">3.4. merge branch</a></li>
<li><a href="#org01c621c">3.5. git add tag</a></li>
</ul>
</li>
</ul>
</div>
</div>
<p>
蒋鑫. Git权威指南 机械工业出版社. Kindle 版本.<br>
</p>
<div id="outline-container-orgdf3b5d5" class="outline-2">
<h2 id="orgdf3b5d5"><span class="section-number-2">1</span> git 独奏</h2>
<div class="outline-text-2" id="text-1">
</div>
<div id="outline-container-org3c38767" class="outline-3">
<h3 id="org3c38767"><span class="section-number-3">1.1</span> git 初始化</h3>
<div class="outline-text-3" id="text-1-1">
<ul class="org-ul">
<li><p>
git init<br>
</p>

<p>
初始化git项目<br>
</p></li>
<li><p>
.git<br>
</p>

<p>
版本库存放目录<br>
</p></li>
<li>git config<br>
修改配置文件<br>
<ul class="org-ul">
<li><p>
git config -e<br>
</p>

<p>
修改 <code>.git/config</code><br>
</p></li>
<li><p>
git config -e &#x2013;global<br>
</p>

<p>
修改 <code>~/.gitconfig</code><br>
</p></li>
<li><p>
git config -e &#x2013;system<br>
</p>

<p>
修改 <code>/etc/gitconfig</code><br>
</p></li>
<li><p>
git config &lt;session&gt;.&lt;key&gt;<br>
</p>

<p>
读写配置文件的属性<br>
<code>$GIT_CONF=test.ini git config a.b</code> 来处理其他配置文件<br>
</p></li>
<li>git config &#x2013;global alias.ci "commit -s"<br>
设置别名<br></li>
</ul></li>
<li>git clone note  note-bak<br>
备份项目<br></li>
</ul>
</div>
</div>
<div id="outline-container-orgc5cc582" class="outline-3">
<h3 id="orgc5cc582"><span class="section-number-3">1.2</span> git 暂存区</h3>
<div class="outline-text-3" id="text-1-2">

<div class="figure">
<p><img src="http://7xpyfe.com1.z0.glb.clouddn.com/2017101515080826245091.png" alt="2017101515080826245091.png"><br>
</p>
</div>

<p>
工作区、暂存区、版本库<br>
</p>
<ul class="org-ul">
<li>git status -s<br></li>
<li>git log &#x2013;pretty=oneline<br></li>
<li><p>
git add note-git.org<br>
</p>

<p>
添加到暂存区<br>
</p></li>
<li><p>
git checkout &#x2013; note-git.org<br>
</p>

<p>
暂存区&#x2013;&gt;工作区<br>
</p></li>
<li><p>
git diff<br>
</p>


<div class="figure">
<p><img src="http://7xpyfe.com1.z0.glb.clouddn.com/20171015150808301278029.png" alt="20171015150808301278029.png"> <br>
</p>
</div>

<p>
diff介绍<br>
</p>

<p>
diff 比较工作区、暂存区、版本库代码<br>
</p>

<p>
git diff 比较工作区和暂存区<br>
</p>

<p>
git diff &#x2013;cached 比较暂存区和HEAD<br>
</p>

<p>
git diff HEAD 比较工作区和HEAD<br>
</p>

<p>
git diff &lt;commit1&gt;&lt;commit2&gt; &#x2013; &lt;paths&gt;  比较不同版本文件的差异<br>
</p></li>
<li><p>
git stash<br>
</p>

<p>
保存进度，暂存状态<br>
</p></li>
</ul>
</div>
</div>
<div id="outline-container-org8a7e146" class="outline-3">
<h3 id="org8a7e146"><span class="section-number-3">1.3</span> git reset 重置</h3>
<div class="outline-text-3" id="text-1-3">
<ol class="org-ol">
<li>git reset HEAD&lt;path&gt;  相当于取消 git add &lt;paths&gt; 操作<br></li>

<li><p>
git reset &#x2013;hard master@{2}  重置master所有位置为两次改变之前的值<br>
</p>

<p>
&#x2013;soft       只改变引用的指向，不改变暂存区和工作区<br>
</p>

<p>
&#x2013;mixed      更改引用的指向，重置暂存区，不改变工作区<br>
</p></li>

<li>git reset &#x2013;soft HEAD^ 放弃最新的提交<br></li>
<li>git reset HEAD filename<br></li>
</ol>
</div>
</div>

<div id="outline-container-org1224446" class="outline-3">
<h3 id="org1224446"><span class="section-number-3">1.4</span> git 检出</h3>
<div class="outline-text-3" id="text-1-4">
<ul class="org-ul">
<li><p>
git checkout branch_name<br>
</p>

<p>
git branch -v<br>
</p></li>
<li>git checkout&#x2013;filename  用暂存区的文件覆盖工作区的 取消上次add<br></li>
</ul>
</div>
</div>
<div id="outline-container-orgfbc6e6e" class="outline-3">
<h3 id="orgfbc6e6e"><span class="section-number-3">1.5</span> git 恢复进度</h3>
<div class="outline-text-3" id="text-1-5">
<ul class="org-ul">
<li><p>
git stash<br>
</p>

<p>
git stash list<br>
</p>

<p>
git stash pop 从最近保持的进度恢复<br>
</p>

<p>
git stash drop 默认删除最新的进度<br>
</p>

<p>
git stash clear 删除所有进度<br>
</p>

<p>
git stash branch &lt;branchname&gt;  基于进度创建分支<br>
</p></li>
</ul>
</div>
</div>

<div id="outline-container-org615a620" class="outline-3">
<h3 id="org615a620"><span class="section-number-3">1.6</span> git 基础操作</h3>
<div class="outline-text-3" id="text-1-6">
<ul class="org-ul">
<li><p>
删除文件<br>
</p>

<p>
git ls-files 查看暂存区文件<br>
</p>

<p>
git rm filename 删除暂存区文件<br>
</p>

<p>
git reset &#x2013;hard HEAD^ 重置上次提交的删除操作<br>
</p>

<p>
git add-u 快速标记操作,下次提交会生效<br>
</p></li>
<li><p>
恢复文件<br>
</p>

<p>
git show HEAD~1:circl.html &gt; circl.html<br>
</p>

<p>
git checkout HEAD~1 &#x2013; circl.html<br>
</p></li>
<li><p>
移动文件<br>
</p>

<p>
git mv a b<br>
</p></li>
<li><p>
选择性添加<br>
</p>

<p>
git add -i 交互窗口<br>
</p></li>
<li><p>
文件忽略<br>
</p>

<p>
在工作目录下添加.gitignore<br>
</p>

<p>
<code>*.pyc</code><br>
</p>

<p>
git status &#x2013;ignored -s 可以查看哪些文件被忽略了<br>
</p>

<p>
git add -f filename 或略的文件强制更新<br>
</p>

<p>
git commit -a -m  "偷懒了 直接提交 不用 git add"<br>
</p></li>
<li><p>
文件归档<br>
</p>

<p>
git archive -o lastest.zip HEAD  最新归档<br>
</p>

<p>
git archive -o partial.tar HEAD src doc  只归档两个文件夹<br>
</p></li>
</ul>
</div>
</div>

<div id="outline-container-orgc0aa750" class="outline-3">
<h3 id="orgc0aa750"><span class="section-number-3">1.7</span> git tools</h3>
<div class="outline-text-3" id="text-1-7">
<p>
版本库浏览器能更好看提交关系图<br>
</p>
<ol class="org-ol">
<li>gitk<br></li>
<li>gitg<br></li>
<li>qgit<br></li>
<li>命令行<br>
<ul class="org-ul">
<li><p>
git log<br>
</p>

<p>
git config &#x2013;global alias.glog "log &#x2013;graph"  使用:git glog &#x2013;oneline<br>
</p></li>
<li><p>
文件追溯<br>
</p>

<p>
git blame filename 逐行显示谁编辑的 追踪bug!<br>
</p></li>
<li><p>
二分查找<br>
</p>

<p>
找到一个好版本和坏版本,在中间版本的master上执行<br>
</p>

<p>
git bisect start<br>
</p></li>
</ul></li>
</ol>
</div>
</div>

<div id="outline-container-org7602843" class="outline-3">
<h3 id="org7602843"><span class="section-number-3">1.8</span> 改变历史</h3>
<div class="outline-text-3" id="text-1-8">
<ul class="org-ul">
<li><p>
单步悔棋<br>
</p>

<p>
git commit &#x2013;amend  修改commit原因<br>
</p>

<p>
git checkout HEAD^ &#x2013;filepath 还原删除的文件到暂存区<br>
</p></li>
<li><p>
多步悔棋<br>
git reset &#x2013;soft HEAD^^ 后退两个版本到暂存区<br>
</p>

<p>
git commit -m "new reason "<br>
</p></li>
</ul>
</div>
</div>

<div id="outline-container-orga77cb6c" class="outline-3">
<h3 id="orga77cb6c"><span class="section-number-3">1.9</span> git克隆</h3>
<div class="outline-text-3" id="text-1-9">
<ul class="org-ul">
<li><p>
git clone<br>
</p>

<p>
git clone &lt;rep&gt; dir<br>
</p>

<p>
git clone &#x2013;bare &lt;rep&gt; dir<br>
</p>

<p>
git clone &#x2013;mirror &lt;rep&gt; dir<br>
</p></li>
<li>git push<br></li>
<li>git pull<br></li>
</ul>
</div>
</div>
</div>

<div id="outline-container-org210a79d" class="outline-2">
<h2 id="org210a79d"><span class="section-number-2">2</span> git 和声</h2>
<div class="outline-text-2" id="text-2">
</div>
<div id="outline-container-org2a472d1" class="outline-3">
<h3 id="org2a472d1"><span class="section-number-3">2.1</span> git 工作协调</h3>
<div class="outline-text-3" id="text-2-1">
<ul class="org-ul">
<li>支持的协议<br>
智能协议: 数据传输过程中有清晰的进度显示,按需传输，传输量小，速度快 (ssh,git,file//)<br>
哑协议: 创术速度慢，传输进度不可见，不知道什么时候完成数据传输(ftp,rsync)<br></li>
<li><p>
强制非快进式推送<br>
</p>

<p>
git rev-list HEAD  本地版本库最新提交<br>
</p>

<p>
git ls-remote origin 远程版本库的引用<br>
</p>

<p>
git push 报non-fast-forward updates were rejected 不可以git push -f 强制更新<br>
</p></li>
<li><p>
合并后推送<br>
</p>

<p>
git pull = git fetch + git merge<br>
</p>

<p>
git log &#x2013;graph &#x2013;oneline<br>
</p>

<p>
git push<br>
</p></li>
</ul>
</div>
</div>


<div id="outline-container-org7fafb5c" class="outline-3">
<h3 id="org7fafb5c"><span class="section-number-3">2.2</span> git 冲突解决</h3>
<div class="outline-text-3" id="text-2-2">
<p>
git merge<br>
</p>

<ol class="org-ol">
<li><p>
自动合并<br>
</p>

<p>
git fetch<br>
</p>

<p>
git merge refs/remotes/origin/master<br>
</p>

<p>
git push<br>
</p>

<p>
git log -1 -m &#x2013;stat  m参数可以查看合并操作<br>
</p></li>
<li>逻辑冲突<br>
<ul class="org-ul">
<li>修改文件名，其他文件引用了原来的文件名<br></li>
<li>函数修改了返回值,但其他地方调用的还是原来的返回值函数<br></li>
</ul></li>
<li><p>
冲突解决<br>
</p>
<ul class="org-ul">
<li><p>
&lt;&lt;&lt;&lt;&lt;&lt;&lt;(七个小于号) 和 <code>=====</code> (七个等于号)<br>
</p>

<p>
当前分支所更改的内容<br>
</p></li>
<li><p>
=======(七个等于号) 和 &gt;&gt;&gt;&gt;&gt;&gt;&gt; (七个大于号)<br>
</p>

<p>
所要合并的版本要更改的内容<br>
</p></li>
</ul>

<p>
git add / git reset<br>
</p></li>
<li>树冲突<br></li>
<li>合并策略<br>
<ul class="org-ul">
<li>resolve<br></li>
<li>recursive<br></li>
</ul></li>
</ol>
</div>
</div>
</div>

<div id="outline-container-org0f1c0f5" class="outline-2">
<h2 id="org0f1c0f5"><span class="section-number-2">3</span> <a href="http://mazhuang.org/wiki/git/">common questions</a></h2>
<div class="outline-text-2" id="text-3">
</div>
<div id="outline-container-org42b1b90" class="outline-3">
<h3 id="org42b1b90"><span class="section-number-3">3.1</span> git ls-files 乱码问题</h3>
<div class="outline-text-3" id="text-3-1">
<p>
在 <code>~/.gitconfig</code> 中添加如下内容<br>
</p>
<pre class="example">
[core]
   quotepath = false
[gui]
   encoding = utf-8
[i18n]
   commitencoding = utf-8
[svn]
   pathnameencoding = utf-8
</pre>
</div>
</div>

<div id="outline-container-org3c4e036" class="outline-3">
<h3 id="org3c4e036"><span class="section-number-3">3.2</span> change git push user</h3>
<div class="outline-text-3" id="text-3-2">
<p>
git config user.name 'xxx'<br>
</p>

<p>
git config user.email 'xxx'<br>
</p>
</div>
</div>
<div id="outline-container-org70a8467" class="outline-3">
<h3 id="org70a8467"><span class="section-number-3">3.3</span> create branch</h3>
<div class="outline-text-3" id="text-3-3">
<p>
查看本地分支   <code>git branch</code><br>
</p>

<p>
查看远程分支  <code>git branch -a</code><br>
</p>

<p>
创建本地分支，并切换到分支 <code>git branch manue1</code> <code>git checkout manue1</code><br>
</p>

<p>
推送创建新的远程分支 <code>git push origin manue1</code><br>
</p>
</div>
</div>

<div id="outline-container-org9862454" class="outline-3">
<h3 id="org9862454"><span class="section-number-3">3.4</span> merge branch</h3>
<div class="outline-text-3" id="text-3-4">
<p>
合并manue1分支到dev <code>git merge manue1</code><br>
</p>
</div>
</div>


<div id="outline-container-org01c621c" class="outline-3">
<h3 id="org01c621c"><span class="section-number-3">3.5</span> git add tag</h3>
<div class="outline-text-3" id="text-3-5">
<p>
<a href="https://git-scm.com/book/zh/v1/Git-%E5%9F%BA%E7%A1%80-%E6%89%93%E6%A0%87%E7%AD%BE">https://git-scm.com/book/zh/v1/Git-基础-打标签</a><br>
</p>

<p>
git tag -a v1.4 -m 'my version 1.4'<br>
</p>

<p>
git push origin &#x2013;tags #一次推送所有本地新增的标签上去</p>
</div>
</div>
</div>
</div>
<div id="postamble" class="status">
<p>
    <a href="">manue1</a> 搭建和维护，使用
    <a href="https://www.gnu.org/software/emacs/">Emacs</a>
    <a href="http://orgmode.org/">Org mode</a> 编辑和构建
</p>
<script src="http://www.langdebuqing.com/css/jquery-2.1.3.min.js"></script>
<script src="http://www.langdebuqing.com/css/main.js"></script>
</div>
</body>
</html>